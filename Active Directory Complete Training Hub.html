<!DOCTYPE html>

<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Active Directory Complete Training Hub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3a8a 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            display: grid;
            grid-template-columns: 320px 1fr;
            box-shadow: 0 0 50px rgba(0,0,0,0.1);
        }

        /* Sidebar */
        .sidebar {
            background: linear-gradient(180deg, #1e40af 0%, #1e3a8a 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            height: 100vh;
            position: sticky;
            top: 0;
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            border-bottom: 2px solid #3b82f6;
            cursor: pointer;
        }

        .logo h1 {
            font-size: 1.4em;
            margin-bottom: 5px;
        }

        .progress-tracker {
            background: rgba(59, 130, 246, 0.2);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: #10b981;
            width: 0%;
            transition: width 0.5s ease;
        }

        .module-nav {
            margin-bottom: 15px;
        }

        .module-header {
            background: rgba(59, 130, 246, 0.3);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .module-header:hover {
            background: rgba(59, 130, 246, 0.4);
        }

        .module-header.completed {
            background: rgba(16, 185, 129, 0.3);
        }

        .lesson-item {
            padding: 8px 15px;
            margin: 3px 0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            font-size: 0.85em;
        }

        .lesson-item:hover {
            background: rgba(255,255,255,0.1);
            border-left-color: #3b82f6;
        }

        .lesson-item.completed {
            background: rgba(16, 185, 129, 0.2);
            border-left-color: #10b981;
        }

        .lesson-item.active {
            background: rgba(59, 130, 246, 0.3);
            border-left-color: #3b82f6;
        }

        .completion-count {
            background: #f59e0b;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75em;
        }

        /* Main Content */
        .main-content {
            overflow-y: auto;
            height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 30px 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .content-area {
            padding: 40px;
        }

        /* Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #3b82f6;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.9em;
        }

        /* Upload Module Styles */
        .upload-area {
            margin: 20px 0;
            padding: 30px;
            background: #f8fafc;
            border-radius: 12px;
            border: 2px dashed #d1d5db;
            text-align: center;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            border-color: #3b82f6;
            background: #f0f9ff;
        }

        .upload-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        #moduleUpload {
            padding: 8px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
        }

        .template-example {
            margin: 20px 0;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .template-summary {
            padding: 15px;
            background: #f3f4f6;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .template-content {
            padding: 15px;
            background: #1f2937;
            color: #e5e7eb;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            display: none;
        }

        .template-example.open .template-content {
            display: block;
        }

        /* Module Management Styles */
        .module-item {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            transition: all 0.3s ease;
        }

        .module-item:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-color: #3b82f6;
        }

        .module-header-info {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .module-title {
            margin: 0 0 5px 0;
            color: #1e40af;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1em;
        }

        .module-meta {
            margin: 0;
            font-size: 0.9em;
            color: #6b7280;
        }

        .module-actions {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.8em;
        }

        .btn-export {
            background: #059669;
            color: white;
        }

        .btn-export:hover {
            background: #047857;
        }

        .btn-remove {
            background: #ef4444;
            color: white;
        }

        .btn-remove:hover {
            background: #dc2626;
        }

        .bulk-actions {
            margin-top: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        .bulk-actions-row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .bulk-help-text {
            font-size: 0.9em;
            color: #6b7280;
        }

        /* Lesson Content */
        .lesson-content {
            display: none;
            max-width: 1000px;
        }

        .lesson-content.active {
            display: block;
        }

        .lesson-header {
            background: #f8fafc;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 5px solid #3b82f6;
        }

        .lesson-title {
            font-size: 2em;
            color: #1e40af;
            margin-bottom: 10px;
        }

        .lesson-meta {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            font-size: 0.9em;
            color: #6b7280;
        }

        .lesson-objectives {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e5e7eb;
        }

        .section-icon {
            font-size: 1.5em;
        }

        .section-title {
            font-size: 1.3em;
            color: #1e40af;
            font-weight: 600;
        }

        .concept { border-left: 5px solid #8b5cf6; }
        .hands-on { border-left: 5px solid #10b981; }
        .reference { border-left: 5px solid #06b6d4; }
        .assessment { border-left: 5px solid #ef4444; }

        /* Commands */
        .command-section {
            background: #f0fdf4;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .command-block {
            background: #1f2937;
            color: #e5e7eb;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            position: relative;
            font-size: 0.9em;
        }

        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #374151;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
        }

        .copy-btn:hover {
            background: #1f2937;
        }

        /* Navigation */
        .lesson-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        /* Lists */
        ul {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 8px 0;
            line-height: 1.6;
        }

        .highlight-box {
            background: #dbeafe;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }

        .warning-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }

        .success-box {
            background: #ecfdf5;
            border-left: 4px solid #10b981;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 6px 6px 0;
        }

        #uploadStatus {
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                height: auto;
                position: relative;
            }
            
            .upload-controls {
                flex-direction: column;
            }
            
            .module-header-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .module-actions {
                align-self: stretch;
            }
            
            .bulk-actions-row {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="logo" onclick="showDashboard()">
                <h1>üìö AD Training Hub</h1>
                <p>Complete Training System</p>
            </div>

            <div class="progress-tracker">
                <h4>Overall Progress</h4>
                <div class="progress-bar">
                    <div class="progress-fill" id="overallProgress" style="width: 0%;"></div>
                </div>
                <div id="progressText">0% Complete</div>
            </div>

            <div id="moduleNavigation"><div class="module-nav"><div class="module-header ">
                    <span>üèóÔ∏è AD Fundamentals</span>
                    <span class="completion-count">0/1</span>
                </div><div class="lesson-item  ">What is Active Directory?</div></div><div class="module-nav"><div class="module-header ">
                    <span>üë• AD Objects</span>
                    <span class="completion-count">0/2</span>
                </div><div class="lesson-item  ">User Management</div><div class="lesson-item  ">Group Management</div></div><div class="module-nav"><div class="module-header ">
                    <span>üîê AD Security &amp; Permissions</span>
                    <span class="completion-count">0/4</span>
                </div><div class="lesson-item  ">NTFS Permissions and Security</div><div class="lesson-item  ">Share Permissions and Access Control</div><div class="lesson-item  ">Delegation and Administrative Rights</div><div class="lesson-item  ">AD Security Hardening</div></div><div class="module-nav"><div class="module-header ">
                    <span>üöÄ Advanced Topics</span>
                    <span class="completion-count">0/1</span>
                </div><div class="lesson-item  ">Backup and Recovery</div></div></div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h1 id="pageTitle">Active Directory Complete Training</h1>
                <p id="pageSubtitle">Comprehensive training with module management system</p>
            </div>

            <div class="content-area">
                <!-- Dashboard View -->
                <div id="dashboardView" style="display: block;">
                    <div class="dashboard">
                        <div class="stat-card">
                            <div class="stat-number" id="totalLessons">8</div>
                            <div class="stat-label">Total Lessons</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="completedLessons">0</div>
                            <div class="stat-label">Completed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalModules">4</div>
                            <div class="stat-label">Modules</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="overallScore">0%</div>
                            <div class="stat-label">Average Score</div>
                        </div>
                    </div>

                    <!-- Enhanced Module Management Section -->
                    <div class="section">
                        <div class="section-header">
                            <span class="section-icon">üìÅ</span>
                            <h2 class="section-title">Module Management</h2>
                        </div>
                        
                        <div class="highlight-box">
                            <strong>Upload New Module:</strong> Upload a JSON file containing lesson content to dynamically add new training modules. Modules are saved and persist across sessions.
                        </div>
                        
                        <div class="upload-area">
                            <div style="font-size: 2em; margin-bottom: 15px;">üì§</div>
                            <p style="margin-bottom: 15px; color: #6b7280;">Drop your JSON module file here or click to browse</p>
                            
                            <div class="upload-controls">
                                <input type="file" id="moduleUpload" accept=".json">
                                <button onclick="uploadModule()" class="btn btn-primary">Upload Module</button>
                                <button onclick="downloadTemplate()" class="btn btn-secondary">Download Template</button>
                            </div>
                            
                            <div id="uploadStatus" style=""></div>
                        </div>

                        <!-- Uploaded Modules Management -->
                        <div id="uploadedModulesSection" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 15px; color: #1e40af; display: flex; align-items: center; gap: 8px;">
                                <span>üéì</span>
                                <span>Uploaded Modules</span>
                            </h3>
                            <div id="uploadedModulesList">
                    <div class="module-item">
                        <div class="module-header-info">
                            <div style="flex: 1;">
                                <h4 class="module-title">
                                    <span>üîê</span>
                                    <span>AD Security &amp; Permissions</span>
                                </h4>
                                <p class="module-meta">
                                    4 lessons ‚Ä¢ Uploaded: 13/9/2025, 10:10:14 am
                                </p>
                                <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #9ca3af;">
                                    File: ad_security_module.json
                                </p>
                            </div>
                            <div class="module-actions">
                                <button onclick="exportModule(&#39;ad-security&#39;)" class="btn btn-export btn-small">
                                    üì• Export
                                </button>
                                <button onclick="removeModule(&#39;ad-security&#39;, true)" class="btn btn-remove btn-small">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                        <div style="font-size: 0.85em; color: #374151; border-top: 1px solid #f3f4f6; padding-top: 10px; margin-top: 10px;">
                            <strong>Lessons:</strong> NTFS Permissions and Security, Share Permissions and Access Control, Delegation and Administrative Rights, AD Security Hardening
                        </div>
                    </div>
                
                    <div class="module-item">
                        <div class="module-header-info">
                            <div style="flex: 1;">
                                <h4 class="module-title">
                                    <span>üöÄ</span>
                                    <span>Advanced Topics</span>
                                </h4>
                                <p class="module-meta">
                                    1 lesson ‚Ä¢ Uploaded: 13/9/2025, 10:10:26 am
                                </p>
                                <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #9ca3af;">
                                    File: ad-training-module-template.json
                                </p>
                            </div>
                            <div class="module-actions">
                                <button onclick="exportModule(&#39;advanced-topics&#39;)" class="btn btn-export btn-small">
                                    üì• Export
                                </button>
                                <button onclick="removeModule(&#39;advanced-topics&#39;, true)" class="btn btn-remove btn-small">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                        <div style="font-size: 0.85em; color: #374151; border-top: 1px solid #f3f4f6; padding-top: 10px; margin-top: 10px;">
                            <strong>Lessons:</strong> Backup and Recovery
                        </div>
                    </div>
                </div>
                            
                            <div class="bulk-actions">
                                <div class="bulk-actions-row">
                                    <button onclick="exportAllModules()" class="btn btn-secondary">üì• Export All Modules</button>
                                    <button onclick="clearAllModules()" class="btn btn-remove">üóëÔ∏è Clear All Modules</button>
                                    <span class="bulk-help-text">Bulk operations for module management</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="template-example" onclick="toggleTemplate()">
                            <div class="template-summary">
                                <span>üìã View Module Format Example</span>
                                <span id="templateToggle">‚ñº</span>
                            </div>
                            <div class="template-content" id="templateContent">
<pre>{
  "moduleId": "advanced-topics",
  "moduleName": "Advanced Topics", 
  "moduleIcon": "üöÄ",
  "lessons": [
    {
      "lessonId": "backup-recovery",
      "title": "Backup and Recovery",
      "duration": "45 minutes",
      "level": "Advanced",
      "objectives": [
        "Understand AD backup strategies",
        "Learn recovery procedures"
      ],
      "sections": [
        {
          "type": "concept",
          "icon": "üíæ",
          "title": "Backup Strategies",
          "content": "&lt;h3&gt;System State Backup&lt;/h3&gt;&lt;p&gt;Content here...&lt;/p&gt;"
        }
      ],
      "quiz": [
        {
          "question": "What is included in system state?",
          "options": ["NTDS.dit only", "Full system", "NTDS + SYSVOL", "Registry only"],
          "correct": "NTDS + SYSVOL",
          "explanation": "System state includes NTDS.dit and SYSVOL..."
        }
      ]
    }
  ]
}</pre>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-header">
                            <span class="section-icon">üéØ</span>
                            <h2 class="section-title">Learning Path Overview</h2>
                        </div>
                        <p>This comprehensive Active Directory training covers essential topics from basic concepts to advanced administration. Each module builds upon previous knowledge and includes hands-on exercises.</p>
                        
                        <div class="highlight-box">
                            <strong>Training Structure:</strong> Each lesson shows complete content at once - no need to click through steps. Upload custom modules to expand your learning!
                        </div>
                        
                        <ul>
                            <li><strong>Module 1:</strong> AD Fundamentals - Core concepts and architecture</li>
                            <li><strong>Module 2:</strong> AD Objects - Users, groups, and computers</li>
                            <li><strong>Custom Modules:</strong> Upload your own specialized training content</li>
                        </ul>
                    </div>
                </div>

                <!-- Sample Lessons -->
                <div id="lesson-what-is-ad" class="lesson-content">
                    <div class="lesson-header">
                        <h1 class="lesson-title">What is Active Directory?</h1>
                        <div class="lesson-meta">
                            <span>üìä Module 1: Fundamentals</span>
                            <span>‚è±Ô∏è 25 minutes</span>
                            <span>üìà Beginner</span>
                        </div>
                        <div class="lesson-objectives">
                            <h3>Learning Objectives:</h3>
                            <ul>
                                <li>Define Active Directory and its core purpose</li>
                                <li>Understand the benefits of centralized directory services</li>
                                <li>Compare AD with workgroup environments</li>
                            </ul>
                        </div>
                    </div>

                    <div class="section concept">
                        <div class="section-header">
                            <span class="section-icon">üí°</span>
                            <h2 class="section-title">Core Concepts</h2>
                        </div>
                        
                        <h3>What is Active Directory?</h3>
                        <p>Active Directory (AD) is Microsoft's directory service that provides centralized authentication, authorization, and management for Windows-based networks.</p>
                        
                        <div class="highlight-box">
                            <strong>Simple Analogy:</strong> If your network was a large office building, Active Directory would be like the security desk, employee directory, and building management system all rolled into one.
                        </div>

                        <h3>Core Benefits:</h3>
                        <ul>
                            <li><strong>Single Sign-On (SSO):</strong> Users authenticate once to access multiple resources</li>
                            <li><strong>Centralized Management:</strong> Manage users, computers, and policies from one location</li>
                            <li><strong>Security:</strong> Consistent security policies across the entire network</li>
                            <li><strong>Scalability:</strong> Supports organizations from 10 to 100,000+ users</li>
                        </ul>
                    </div>

                    <div class="lesson-nav">
                        <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                        <button class="btn btn-success" onclick="completeLesson(&#39;what-is-ad&#39;)">Mark as Complete ‚úì</button>
                        <button class="btn btn-primary" onclick="loadLesson(&#39;user-management&#39;)">Next: User Management ‚Üí</button>
                    </div>
                </div>

                <div id="lesson-user-management" class="lesson-content">
                    <div class="lesson-header">
                        <h1 class="lesson-title">User Account Management</h1>
                        <div class="lesson-meta">
                            <span>üë• Module 2: AD Objects</span>
                            <span>‚è±Ô∏è 40 minutes</span>
                            <span>üìà Intermediate</span>
                        </div>
                        <div class="lesson-objectives">
                            <h3>Learning Objectives:</h3>
                            <ul>
                                <li>Create and configure user accounts</li>
                                <li>Understand user account properties and attributes</li>
                                <li>Manage user passwords and account policies</li>
                            </ul>
                        </div>
                    </div>

                    <div class="section hands-on">
                        <div class="section-header">
                            <span class="section-icon">‚öôÔ∏è</span>
                            <h2 class="section-title">Creating and Managing Users</h2>
                        </div>
                        
                        <div class="command-section">
                            <h3>Creating User Accounts</h3>
                            
                            <div class="command-block">
                                <button class="copy-btn" onclick="copyToClipboard(&#39;New-ADUser -Name \" john="" smith\"="" -samaccountname="" \"jsmith\"')"="">Copy</button>
                                New-ADUser -Name "John Smith" -SamAccountName "jsmith"
                            </div>
                            
                            <div class="command-block">
                                <button class="copy-btn" onclick="copyToClipboard(&#39;Get-ADUser -Identity \" jsmith\"="" -properties="" *')"="">Copy</button>
                                Get-ADUser -Identity "jsmith" -Properties *
                            </div>
                        </div>
                    </div>

                    <div class="lesson-nav">
                        <button class="btn btn-secondary" onclick="loadLesson(&#39;what-is-ad&#39;)">‚Üê Previous: What is AD</button>
                        <button class="btn btn-success" onclick="completeLesson(&#39;user-management&#39;)">Mark as Complete ‚úì</button>
                        <button class="btn btn-primary" onclick="loadLesson(&#39;group-management&#39;)">Next: Group Management ‚Üí</button>
                    </div>
                </div>

                <div id="lesson-group-management" class="lesson-content">
                    <div class="lesson-header">
                        <h1 class="lesson-title">Group Management</h1>
                        <div class="lesson-meta">
                            <span>üë• Module 2: AD Objects</span>
                            <span>‚è±Ô∏è 35 minutes</span>
                            <span>üìà Intermediate</span>
                        </div>
                        <div class="lesson-objectives">
                            <h3>Learning Objectives:</h3>
                            <ul>
                                <li>Understand group types and scopes</li>
                                <li>Create and manage security groups</li>
                                <li>Implement AGDLP strategy</li>
                            </ul>
                        </div>
                    </div>

                    <div class="section concept">
                        <div class="section-header">
                            <span class="section-icon">üë•</span>
                            <h2 class="section-title">Group Types and Scopes</h2>
                        </div>
                        
                        <h3>Security Groups</h3>
                        <ul>
                            <li>Used for assigning permissions to resources</li>
                            <li>Can be used for email distribution</li>
                            <li>Members inherit permissions assigned to the group</li>
                        </ul>
                        
                        <h3>Distribution Groups</h3>
                        <ul>
                            <li>Used only for email distribution lists</li>
                            <li>Cannot be assigned security permissions</li>
                            <li>Primarily used with Exchange Server</li>
                        </ul>
                    </div>

                    <div class="lesson-nav">
                        <button class="btn btn-secondary" onclick="loadLesson(&#39;user-management&#39;)">‚Üê Previous: User Management</button>
                        <button class="btn btn-success" onclick="completeLesson(&#39;group-management&#39;)">Mark as Complete ‚úì</button>
                        <button class="btn btn-primary" onclick="showDashboard()">Back to Dashboard</button>
                    </div>
                </div>
            <div id="lesson-ntfs-permissions" class="lesson-content">
                <div class="lesson-header">
                    <h1 class="lesson-title">NTFS Permissions and Security</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: AD Security &amp; Permissions</span>
                        <span>‚è±Ô∏è 50 minutes</span>
                        <span>üìà Intermediate</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            <li>Understand NTFS permission types and inheritance</li><li>Configure file and folder permissions effectively</li><li>Troubleshoot permission issues</li><li>Implement security best practices for file systems</li>
                        </ul>
                    </div>
                </div>
                
                        <div class="section concept">
                            <div class="section-header">
                                <span class="section-icon">üõ°Ô∏è</span>
                                <h2 class="section-title">NTFS Permission Types</h2>
                            </div>
                            <h3>Standard Permissions</h3><p>NTFS provides six standard permissions that control what users and groups can do with files and folders:</p><ul><li><strong>Full Control:</strong> Complete access including ability to change permissions and take ownership</li><li><strong>Modify:</strong> Read, write, execute, and delete files and subfolders</li><li><strong>Read &amp; Execute:</strong> View files, run programs, and navigate folders</li><li><strong>Read:</strong> View files and folder contents</li><li><strong>Write:</strong> Create new files and folders, modify existing files</li><li><strong>List Folder Contents:</strong> View folder contents (folders only)</li></ul><div class="highlight-box"><strong>Permission Inheritance:</strong> Child objects inherit permissions from parent containers unless inheritance is explicitly disabled or overridden.</div><h3>Advanced Permissions</h3><p>NTFS also provides 13 advanced permissions for granular control:</p><ul><li>Traverse Folder/Execute File</li><li>List Folder/Read Data</li><li>Read Attributes and Extended Attributes</li><li>Create Files/Write Data</li><li>Create Folders/Append Data</li><li>Write Attributes and Extended Attributes</li><li>Delete Subfolders and Files</li><li>Delete</li><li>Read Permissions</li><li>Change Permissions</li><li>Take Ownership</li><li>Synchronize</li></ul>
                        </div>
                    
                        <div class="section hands-on">
                            <div class="section-header">
                                <span class="section-icon">‚öôÔ∏è</span>
                                <h2 class="section-title">Managing NTFS Permissions</h2>
                            </div>
                            <div class="command-section"><h3>PowerShell Permission Management</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-Acl C:\\SharedFolder | Format-List&quot;)">Copy</button>Get-Acl C:\SharedFolder | Format-List</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">View current permissions on a folder</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;$acl = Get-Acl C:\\SharedFolder; $acl.SetAccessRuleProtection($true, $false); Set-Acl C:\\SharedFolder $acl&quot;)">Copy</button>$acl = Get-Acl C:\SharedFolder<br>$acl.SetAccessRuleProtection($true, $false)<br>Set-Acl C:\SharedFolder $acl</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Disable inheritance and remove inherited permissions</p><h3>Adding Permissions</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;$acl = Get-Acl C:\\SharedFolder; $rule = New-Object System.Security.AccessControl.FileSystemAccessRule(\&quot;DOMAIN\\Sales\&quot;,\&quot;ReadAndExecute\&quot;,\&quot;ContainerInherit,ObjectInherit\&quot;,\&quot;None\&quot;,\&quot;Allow\&quot;); $acl.SetAccessRule($rule); Set-Acl C:\\SharedFolder $acl&quot;)">Copy</button>$acl = Get-Acl C:\SharedFolder<br>$rule = New-Object System.Security.AccessControl.FileSystemAccessRule("DOMAIN\Sales","ReadAndExecute","ContainerInherit,ObjectInherit","None","Allow")<br>$acl.SetAccessRule($rule)<br>Set-Acl C:\SharedFolder $acl</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Grant ReadAndExecute to Sales group with inheritance</p><h3>Removing Permissions</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;$acl = Get-Acl C:\\SharedFolder; $acl.PurgeAccessRules([System.Security.Principal.NTAccount]\&quot;DOMAIN\\OldGroup\&quot;); Set-Acl C:\\SharedFolder $acl&quot;)">Copy</button>$acl = Get-Acl C:\SharedFolder<br>$acl.PurgeAccessRules([System.Security.Principal.NTAccount]"DOMAIN\OldGroup")<br>Set-Acl C:\SharedFolder $acl</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Remove all permissions for a specific group</p></div>
                        </div>
                    
                        <div class="section reference">
                            <div class="section-header">
                                <span class="section-icon">üìã</span>
                                <h2 class="section-title">Permission Troubleshooting Matrix</h2>
                            </div>
                            <table class="reference-table"><thead><tr><th>Issue</th><th>Possible Cause</th><th>Diagnostic Command</th><th>Resolution</th></tr></thead><tbody><tr><td>Access Denied Error</td><td>Insufficient permissions</td><td>Get-Acl path | Select-Object -ExpandProperty Access</td><td>Grant appropriate permissions or add user to authorized group</td></tr><tr><td>Can't Delete File</td><td>No Delete permission</td><td>icacls filename /q</td><td>Grant Delete or Full Control permission</td></tr><tr><td>Inheritance Not Working</td><td>Inheritance disabled</td><td>Get-Acl path | Select-Object -ExpandProperty AreAccessRulesProtected</td><td>Enable inheritance: $acl.SetAccessRuleProtection($false, $true)</td></tr><tr><td>Effective Access Unknown</td><td>Complex permission stack</td><td>Get-NTFSEffectiveAccess -Path C:\folder -Account DOMAIN\user</td><td>Use Effective Access tab in Security properties</td></tr></tbody></table>
                        </div>
                    
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson(&#39;ntfs-permissions&#39;)">Mark as Complete ‚úì</button>
                </div>
            </div><div id="lesson-share-permissions" class="lesson-content">
                <div class="lesson-header">
                    <h1 class="lesson-title">Share Permissions and Access Control</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: AD Security &amp; Permissions</span>
                        <span>‚è±Ô∏è 40 minutes</span>
                        <span>üìà Intermediate</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            <li>Configure share permissions and security</li><li>Understand the relationship between share and NTFS permissions</li><li>Implement secure file sharing strategies</li><li>Troubleshoot share access issues</li>
                        </ul>
                    </div>
                </div>
                
                        <div class="section concept">
                            <div class="section-header">
                                <span class="section-icon">üìÅ</span>
                                <h2 class="section-title">Share vs NTFS Permissions</h2>
                            </div>
                            <h3>Understanding the Dual Permission Model</h3><p>Windows file shares use two layers of permissions that work together:</p><div class="highlight-box"><strong>Key Principle:</strong> The most restrictive permission between Share and NTFS permissions always wins. Users get the INTERSECTION of both permission sets.</div><h3>Share Permissions (3 types)</h3><ul><li><strong>Full Control:</strong> Complete access to the share including changing share permissions</li><li><strong>Change:</strong> Read, write, execute, and delete files within the share</li><li><strong>Read:</strong> View and execute files, cannot modify</li></ul><h3>When Each Permission Type Applies</h3><ul><li><strong>Share Permissions:</strong> Only apply when accessing files over the network (UNC paths)</li><li><strong>NTFS Permissions:</strong> Apply both locally and over the network</li><li><strong>Local Access:</strong> Only NTFS permissions matter</li><li><strong>Network Access:</strong> Both share AND NTFS permissions are evaluated</li></ul><div class="warning-box"><strong>Best Practice:</strong> Set share permissions to Full Control for Everyone, then use NTFS permissions for detailed access control. This simplifies management and reduces confusion.</div>
                        </div>
                    
                        <div class="section hands-on">
                            <div class="section-header">
                                <span class="section-icon">üîß</span>
                                <h2 class="section-title">Creating and Managing Shares</h2>
                            </div>
                            <div class="command-section"><h3>Creating Shares with PowerShell</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;New-SmbShare -Name \&quot;CompanyDocs\&quot; -Path \&quot;C:\\SharedFolders\\Documents\&quot; -Description \&quot;Company document repository\&quot;&quot;)">Copy</button>New-SmbShare -Name "CompanyDocs" -Path "C:\SharedFolders\Documents" -Description "Company document repository"</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Create a new file share</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Grant-SmbShareAccess -Name \&quot;CompanyDocs\&quot; -AccountName \&quot;DOMAIN\\Sales\&quot; -AccessRight Change -Force&quot;)">Copy</button>Grant-SmbShareAccess -Name "CompanyDocs" -AccountName "DOMAIN\Sales" -AccessRight Change -Force</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Grant Change permission to Sales group</p><h3>Managing Share Permissions</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-SmbShare | Format-Table Name,Path,Description&quot;)">Copy</button>Get-SmbShare | Format-Table Name,Path,Description</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">List all shares on the server</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-SmbShareAccess -Name \&quot;CompanyDocs\&quot;&quot;)">Copy</button>Get-SmbShareAccess -Name "CompanyDocs"</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">View share permissions</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Revoke-SmbShareAccess -Name \&quot;CompanyDocs\&quot; -AccountName \&quot;Everyone\&quot; -Force&quot;)">Copy</button>Revoke-SmbShareAccess -Name "CompanyDocs" -AccountName "Everyone" -Force</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Remove Everyone group from share permissions</p><h3>Advanced Share Configuration</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Set-SmbShare -Name \&quot;CompanyDocs\&quot; -ConcurrentUserLimit 50 -EncryptData $true&quot;)">Copy</button>Set-SmbShare -Name "CompanyDocs" -ConcurrentUserLimit 50 -EncryptData $true</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Set concurrent user limit and enable SMB encryption</p></div>
                        </div>
                    
                        <div class="section reference">
                            <div class="section-header">
                                <span class="section-icon">üîç</span>
                                <h2 class="section-title">Permission Calculation Examples</h2>
                            </div>
                            <h3>Effective Permission Scenarios</h3><table class="reference-table"><thead><tr><th>Share Permission</th><th>NTFS Permission</th><th>Effective Permission</th><th>Explanation</th></tr></thead><tbody><tr><td>Full Control</td><td>Read</td><td>Read</td><td>NTFS is more restrictive</td></tr><tr><td>Read</td><td>Full Control</td><td>Read</td><td>Share is more restrictive</td></tr><tr><td>Change</td><td>Modify</td><td>Modify</td><td>Both allow modify, NTFS more specific</td></tr><tr><td>Full Control</td><td>Write</td><td>Write</td><td>NTFS is more restrictive</td></tr><tr><td>None (No Access)</td><td>Full Control</td><td>No Access</td><td>Share denial overrides all</td></tr></tbody></table><div class="success-box"><strong>Pro Tip:</strong> To calculate effective permissions quickly, find the most restrictive permission at each layer and apply that. Use "Effective Access" in the Advanced Security Settings to verify complex scenarios.</div>
                        </div>
                    
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson(&#39;share-permissions&#39;)">Mark as Complete ‚úì</button>
                </div>
            </div><div id="lesson-delegation-rights" class="lesson-content">
                <div class="lesson-header">
                    <h1 class="lesson-title">Delegation and Administrative Rights</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: AD Security &amp; Permissions</span>
                        <span>‚è±Ô∏è 45 minutes</span>
                        <span>üìà Advanced</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            <li>Understand Active Directory delegation concepts</li><li>Configure delegation of control for OUs and objects</li><li>Implement principle of least privilege</li><li>Manage administrative rights securely</li>
                        </ul>
                    </div>
                </div>
                
                        <div class="section concept">
                            <div class="section-header">
                                <span class="section-icon">üëë</span>
                                <h2 class="section-title">Delegation Principles</h2>
                            </div>
                            <h3>What is Delegation?</h3><p>Delegation in Active Directory allows you to grant specific administrative permissions to users or groups without giving them full administrative rights. This implements the principle of least privilege.</p><div class="highlight-box"><strong>Principle of Least Privilege:</strong> Users should have only the minimum permissions necessary to perform their job functions, nothing more.</div><h3>Types of Delegation</h3><ul><li><strong>Full Control:</strong> Complete administrative access to an OU and all child objects</li><li><strong>Common Tasks:</strong> Pre-defined tasks like password resets, account management</li><li><strong>Custom Tasks:</strong> Specific permissions on specific object types</li></ul><h3>Delegation Scope</h3><ul><li><strong>This object only:</strong> Permissions apply only to the selected object</li><li><strong>This object and all descendant objects:</strong> Permissions inherit to child objects</li><li><strong>Descendant objects only:</strong> Permissions apply to child objects but not the parent</li></ul><div class="warning-box"><strong>Security Consideration:</strong> Be cautious with delegation at high levels in the directory tree. Delegating at the domain level affects all objects in the domain.</div>
                        </div>
                    
                        <div class="section hands-on">
                            <div class="section-header">
                                <span class="section-icon">üîê</span>
                                <h2 class="section-title">Implementing Delegation</h2>
                            </div>
                            <div class="command-section"><h3>Using dsacls for Delegation</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;dsacls \&quot;OU=Sales,DC=company,DC=com\&quot; /G \&quot;COMPANY\\HelpDesk:RPWP;pwdLastSet\&quot; /I:S&quot;)">Copy</button>dsacls "OU=Sales,DC=company,DC=com" /G "COMPANY\HelpDesk:RPWP;pwdLastSet" /I:S</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Grant HelpDesk group permission to read and write pwdLastSet attribute</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;dsacls \&quot;OU=Sales,DC=company,DC=com\&quot; /G \&quot;COMPANY\\PasswordAdmins:CA;Reset Password\&quot; /I:S&quot;)">Copy</button>dsacls "OU=Sales,DC=company,DC=com" /G "COMPANY\PasswordAdmins:CA;Reset Password" /I:S</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Grant permission to reset passwords on user objects</p><h3>PowerShell Delegation Commands</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Import-Module ActiveDirectory; $acl = Get-Acl \&quot;AD:OU=Sales,DC=company,DC=com\&quot;; $sid = (Get-ADGroup \&quot;HelpDesk\&quot;).SID; $rule = New-Object System.DirectoryServices.ActiveDirectoryAccessRule($sid,\&quot;ReadProperty,WriteProperty\&quot;,\&quot;Allow\&quot;,\&quot;00000000-0000-0000-0000-000000000000\&quot;,\&quot;Descendents\&quot;,\&quot;bf967aba-0de6-11d0-a285-00aa003049e2\&quot;); $acl.SetAccessRule($rule); Set-Acl \&quot;AD:OU=Sales,DC=company,DC=com\&quot; $acl&quot;)">Copy</button>Import-Module ActiveDirectory<br>$acl = Get-Acl "AD:OU=Sales,DC=company,DC=com"<br>$sid = (Get-ADGroup "HelpDesk").SID<br>$rule = New-Object System.DirectoryServices.ActiveDirectoryAccessRule($sid,"ReadProperty,WriteProperty","Allow","00000000-0000-0000-0000-000000000000","Descendents","bf967aba-0de6-11d0-a285-00aa003049e2")<br>$acl.SetAccessRule($rule)<br>Set-Acl "AD:OU=Sales,DC=company,DC=com" $acl</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">PowerShell method to delegate user management permissions</p><h3>Viewing Effective Rights</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;dsacls \&quot;OU=Sales,DC=company,DC=com\&quot; /A&quot;)">Copy</button>dsacls "OU=Sales,DC=company,DC=com" /A</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">View all permissions on an OU</p></div>
                        </div>
                    
                        <div class="section reference">
                            <div class="section-header">
                                <span class="section-icon">üìä</span>
                                <h2 class="section-title">Common Delegation Scenarios</h2>
                            </div>
                            <table class="reference-table"><thead><tr><th>Role</th><th>Required Permissions</th><th>Delegation Scope</th><th>Implementation</th></tr></thead><tbody><tr><td>Help Desk</td><td>Reset passwords, unlock accounts, enable/disable accounts</td><td>Specific OUs</td><td>Use Delegation of Control Wizard</td></tr><tr><td>HR Admin</td><td>Create/delete user accounts, modify user properties</td><td>Users OU</td><td>Grant Create/Delete User Objects + Write All Properties</td></tr><tr><td>Group Manager</td><td>Modify group membership</td><td>Groups OU</td><td>Grant Write property: member</td></tr><tr><td>Computer Admin</td><td>Join computers to domain, manage computer accounts</td><td>Computers OU</td><td>Grant Create/Delete Computer Objects</td></tr><tr><td>GPO Admin</td><td>Create and link GPOs</td><td>Domain/OU level</td><td>Grant Create groupPolicyContainer + Write gpLink</td></tr></tbody></table><div class="success-box"><strong>Delegation Best Practices:</strong><ul><li>Use security groups for delegation, not individual users</li><li>Document all delegated permissions</li><li>Regularly audit delegated permissions</li><li>Test delegated permissions in non-production first</li><li>Use descriptive group names that indicate purpose</li></ul></div>
                        </div>
                    
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson(&#39;delegation-rights&#39;)">Mark as Complete ‚úì</button>
                </div>
            </div><div id="lesson-security-hardening" class="lesson-content">
                <div class="lesson-header">
                    <h1 class="lesson-title">AD Security Hardening</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: AD Security &amp; Permissions</span>
                        <span>‚è±Ô∏è 55 minutes</span>
                        <span>üìà Advanced</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            <li>Implement Active Directory security best practices</li><li>Configure advanced security settings and policies</li><li>Understand and mitigate common AD attack vectors</li><li>Monitor and audit AD security events</li>
                        </ul>
                    </div>
                </div>
                
                        <div class="section concept">
                            <div class="section-header">
                                <span class="section-icon">üõ°Ô∏è</span>
                                <h2 class="section-title">AD Security Hardening Fundamentals</h2>
                            </div>
                            <h3>Core Security Principles</h3><p>Active Directory hardening involves implementing multiple layers of security controls to protect against both external and internal threats.</p><div class="highlight-box"><strong>Defense in Depth:</strong> Implement multiple overlapping security controls rather than relying on a single security measure.</div><h3>Critical Security Areas</h3><ul><li><strong>Privileged Account Management:</strong> Secure administrative accounts and limit their usage</li><li><strong>Credential Protection:</strong> Prevent credential theft and misuse</li><li><strong>Network Segmentation:</strong> Isolate domain controllers and critical systems</li><li><strong>Audit and Monitoring:</strong> Detect suspicious activities and security breaches</li><li><strong>Patch Management:</strong> Keep domain controllers and member systems updated</li></ul><h3>Common Attack Vectors</h3><ul><li><strong>Kerberoasting:</strong> Attacking service accounts with weak passwords</li><li><strong>Golden Ticket:</strong> Forging Kerberos tickets using compromised krbtgt account</li><li><strong>DCSync:</strong> Replicating directory data using legitimate AD replication</li><li><strong>Pass-the-Hash:</strong> Using stolen password hashes for authentication</li><li><strong>Privilege Escalation:</strong> Exploiting misconfigurations to gain higher privileges</li></ul><div class="warning-box"><strong>Critical:</strong> Regular security assessments and penetration testing are essential to identify vulnerabilities before attackers do.</div>
                        </div>
                    
                        <div class="section hands-on">
                            <div class="section-header">
                                <span class="section-icon">‚öôÔ∏è</span>
                                <h2 class="section-title">Implementing Security Controls</h2>
                            </div>
                            <div class="command-section"><h3>Privileged Account Security</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-ADUser -Filter {AdminCount -eq 1} -Properties AdminCount,LastLogonDate | Format-Table Name,LastLogonDate&quot;)">Copy</button>Get-ADUser -Filter {AdminCount -eq 1} -Properties AdminCount,LastLogonDate | Format-Table Name,LastLogonDate</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Identify privileged accounts and their last logon</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Search-ADAccount -AccountInactive -TimeSpan 90 -UsersOnly | Where-Object {$_.AdminCount -eq 1}&quot;)">Copy</button>Search-ADAccount -AccountInactive -TimeSpan 90 -UsersOnly | Where-Object {$_.AdminCount -eq 1}</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Find inactive privileged accounts</p><h3>Service Account Hardening</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-ADUser -Filter {ServicePrincipalName -like \&quot;*\&quot;} -Properties ServicePrincipalName,PasswordLastSet | Format-Table Name,ServicePrincipalName,PasswordLastSet&quot;)">Copy</button>Get-ADUser -Filter {ServicePrincipalName -like "*"} -Properties ServicePrincipalName,PasswordLastSet | Format-Table Name,ServicePrincipalName,PasswordLastSet</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Audit service accounts and password ages</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Set-ADUser -Identity \&quot;svc-webserver\&quot; -KerberosEncryptionType AES128,AES256&quot;)">Copy</button>Set-ADUser -Identity "svc-webserver" -KerberosEncryptionType AES128,AES256</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Enable AES encryption for service account</p><h3>Security Auditing</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;auditpol /set /subcategory:\&quot;Directory Service Access\&quot; /success:enable /failure:enable&quot;)">Copy</button>auditpol /set /subcategory:"Directory Service Access" /success:enable /failure:enable</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Enable auditing for directory service access</p><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-WinEvent -LogName Security -FilterHashtable @{ID=4624,4625} -MaxEvents 100 | Format-Table TimeCreated,Id,LevelDisplayName,Message&quot;)">Copy</button>Get-WinEvent -LogName Security -FilterHashtable @{ID=4624,4625} -MaxEvents 100 | Format-Table TimeCreated,Id,LevelDisplayName,Message</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Review logon success and failure events</p><h3>Domain Controller Security</h3><div class="command-block"><button class="copy-btn" onclick="copyToClipboard(&quot;Get-ADReplicationFailure -Target * | Format-Table Server,Partner,FailureType,FirstFailureTime&quot;)">Copy</button>Get-ADReplicationFailure -Target * | Format-Table Server,Partner,FailureType,FirstFailureTime</div><p style="margin: 5px 0; font-size: 0.9em; color: #6b7280;">Check for replication failures that might indicate attacks</p></div>
                        </div>
                    
                        <div class="section reference">
                            <div class="section-header">
                                <span class="section-icon">üìà</span>
                                <h2 class="section-title">Security Monitoring Checklist</h2>
                            </div>
                            <h3>Daily Security Checks</h3><table class="reference-table"><thead><tr><th>Check</th><th>Command/Tool</th><th>What to Look For</th><th>Red Flags</th></tr></thead><tbody><tr><td>Failed Logons</td><td>Get-WinEvent Security -ID 4625</td><td>Pattern of failed attempts</td><td>Brute force attacks, account enumeration</td></tr><tr><td>Privileged Logons</td><td>Get-WinEvent Security -ID 4672</td><td>Administrative account usage</td><td>Unexpected privileged access</td></tr><tr><td>Account Lockouts</td><td>Get-WinEvent Security -ID 4740</td><td>Locked user accounts</td><td>Password attacks, service account issues</td></tr><tr><td>Group Changes</td><td>Get-WinEvent Security -ID 4728,4729</td><td>Membership modifications</td><td>Unauthorized privilege escalation</td></tr><tr><td>Policy Changes</td><td>Get-WinEvent Security -ID 4719</td><td>Security policy modifications</td><td>Unauthorized configuration changes</td></tr></tbody></table><div class="warning-box"><strong>Immediate Actions for Security Incidents:</strong><ol><li>Isolate affected systems from the network</li><li>Preserve evidence and log files</li><li>Reset passwords for compromised accounts</li><li>Review and revoke unnecessary privileges</li><li>Implement additional monitoring</li><li>Conduct forensic analysis</li></ol></div>
                        </div>
                    
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson(&#39;security-hardening&#39;)">Mark as Complete ‚úì</button>
                </div>
            </div><div id="lesson-backup-recovery" class="lesson-content">
                <div class="lesson-header">
                    <h1 class="lesson-title">Backup and Recovery</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: Advanced Topics</span>
                        <span>‚è±Ô∏è 45 minutes</span>
                        <span>üìà Advanced</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            <li>Understand AD backup strategies</li><li>Learn system state backup procedures</li><li>Practice disaster recovery scenarios</li>
                        </ul>
                    </div>
                </div>
                
                        <div class="section concept">
                            <div class="section-header">
                                <span class="section-icon">üíæ</span>
                                <h2 class="section-title">Backup Strategies</h2>
                            </div>
                            <h3>System State Backup</h3><p>The system state includes the Active Directory database, SYSVOL, registry, and other critical system files.</p><div class="highlight-box"><strong>Backup Components:</strong><ul><li>NTDS.dit database file</li><li>SYSVOL folder</li><li>Registry settings</li></ul></div>
                        </div>
                    
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson(&#39;backup-recovery&#39;)">Mark as Complete ‚úì</button>
                </div>
            </div></div>
        </div>
    </div>

    <script>
        // Training data structure
        const trainingData = {
            modules: {
                'fundamentals': {
                    name: 'AD Fundamentals',
                    icon: 'üèóÔ∏è',
                    lessons: ['what-is-ad']
                },
                'objects': {
                    name: 'AD Objects',
                    icon: 'üë•', 
                    lessons: ['user-management', 'group-management']
                }
            },
            
            lessons: {
                'what-is-ad': { title: 'What is Active Directory?', module: 'fundamentals' },
                'user-management': { title: 'User Management', module: 'objects' },
                'group-management': { title: 'Group Management', module: 'objects' }
            }
        };

        // Application state with enhanced module management
        let userProgress = {};
        let currentView = 'dashboard';
        let currentLesson = null;
        let uploadedModules = {}; // Store uploaded modules with metadata

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            generateNavigation();
            updateProgressTracking();
            updateUploadedModulesList();
            showDashboard();
        });

        // Enhanced Upload Module Functions
        function uploadModule() {
            const fileInput = document.getElementById('moduleUpload');
            
            if (!fileInput.files[0]) {
                showStatus('Please select a JSON file to upload.', 'error');
                return;
            }
            
            const file = fileInput.files[0];
            if (!file.name.endsWith('.json')) {
                showStatus('Please upload a valid JSON file.', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const moduleData = JSON.parse(e.target.result);
                    if (validateModuleData(moduleData)) {
                        // Check for duplicate module ID
                        if (uploadedModules[moduleData.moduleId]) {
                            if (!confirm(`Module "${moduleData.moduleId}" already exists. Replace it?`)) {
                                return;
                            }
                            removeModule(moduleData.moduleId, false); // Remove existing without confirmation
                        }
                        
                        integrateModule(moduleData);
                        saveUploadedModule(moduleData, file.name);
                        showStatus('‚úì Module uploaded and saved successfully!', 'success');
                        fileInput.value = '';
                    } else {
                        showStatus('Invalid module format. Please check the template.', 'error');
                    }
                } catch (error) {
                    showStatus('Error parsing JSON file: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }
        
        function saveUploadedModule(moduleData, fileName) {
            uploadedModules[moduleData.moduleId] = {
                data: moduleData,
                fileName: fileName,
                uploadDate: new Date().toISOString(),
                uploadTime: new Date().toLocaleString()
            };
            updateUploadedModulesList();
        }
        
        function updateUploadedModulesList() {
            const listContainer = document.getElementById('uploadedModulesList');
            
            if (Object.keys(uploadedModules).length === 0) {
                listContainer.innerHTML = `
                    <p style="color: #6b7280; font-style: italic; padding: 20px; background: #f9fafb; border-radius: 8px; text-align: center;">
                        No custom modules uploaded yet. Upload your first module using the form above!
                    </p>
                `;
                return;
            }
            
            let html = '';
            Object.entries(uploadedModules).forEach(([moduleId, moduleInfo]) => {
                const module = moduleInfo.data;
                const lessonCount = module.lessons.length;
                
                html += `
                    <div class="module-item">
                        <div class="module-header-info">
                            <div style="flex: 1;">
                                <h4 class="module-title">
                                    <span>${module.moduleIcon}</span>
                                    <span>${module.moduleName}</span>
                                </h4>
                                <p class="module-meta">
                                    ${lessonCount} lesson${lessonCount !== 1 ? 's' : ''} ‚Ä¢ Uploaded: ${moduleInfo.uploadTime}
                                </p>
                                <p style="margin: 5px 0 0 0; font-size: 0.85em; color: #9ca3af;">
                                    File: ${moduleInfo.fileName}
                                </p>
                            </div>
                            <div class="module-actions">
                                <button onclick="exportModule('${moduleId}')" class="btn btn-export btn-small">
                                    üì• Export
                                </button>
                                <button onclick="removeModule('${moduleId}', true)" class="btn btn-remove btn-small">
                                    üóëÔ∏è Remove
                                </button>
                            </div>
                        </div>
                        <div style="font-size: 0.85em; color: #374151; border-top: 1px solid #f3f4f6; padding-top: 10px; margin-top: 10px;">
                            <strong>Lessons:</strong> ${module.lessons.map(lesson => lesson.title).join(', ')}
                        </div>
                    </div>
                `;
            });
            
            listContainer.innerHTML = html;
        }
        
        function removeModule(moduleId, confirmAction = true) {
            if (confirmAction && !confirm(`Are you sure you want to remove the "${uploadedModules[moduleId].data.moduleName}" module? This action cannot be undone.`)) {
                return;
            }
            
            const moduleData = uploadedModules[moduleId].data;
            
            // Remove from training data
            delete trainingData.modules[moduleId];
            
            // Remove lessons
            moduleData.lessons.forEach(lesson => {
                delete trainingData.lessons[lesson.lessonId];
                
                // Remove lesson HTML
                const lessonElement = document.getElementById(`lesson-${lesson.lessonId}`);
                if (lessonElement) {
                    lessonElement.remove();
                }
                
                // Remove from user progress
                delete userProgress[lesson.lessonId];
            });
            
            // Remove from uploaded modules
            delete uploadedModules[moduleId];
            
            // Update UI
            generateNavigation();
            updateProgressTracking();
            updateStats();
            updateUploadedModulesList();
            
            // If currently viewing a lesson from this module, go back to dashboard
            if (currentLesson && moduleData.lessons.some(lesson => lesson.lessonId === currentLesson)) {
                showDashboard();
            }
            
            showStatus(`‚úì Module "${moduleData.moduleName}" removed successfully.`, 'success');
        }
        
        function exportModule(moduleId) {
            const moduleInfo = uploadedModules[moduleId];
            if (!moduleInfo) return;
            
            const blob = new Blob([JSON.stringify(moduleInfo.data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${moduleId}-module.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus(`‚úì Module "${moduleInfo.data.moduleName}" exported successfully.`, 'success');
        }
        
        function exportAllModules() {
            if (Object.keys(uploadedModules).length === 0) {
                showStatus('No modules to export.', 'error');
                return;
            }
            
            const allModules = Object.values(uploadedModules).map(info => info.data);
            const exportData = {
                exportDate: new Date().toISOString(),
                exportVersion: "1.0",
                modules: allModules
            };
            
            const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ad-training-modules-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showStatus(`‚úì All ${allModules.length} modules exported successfully.`, 'success');
        }
        
        function clearAllModules() {
            if (Object.keys(uploadedModules).length === 0) {
                showStatus('No modules to clear.', 'error');
                return;
            }
            
            if (!confirm(`Are you sure you want to remove ALL ${Object.keys(uploadedModules).length} uploaded modules? This action cannot be undone.\n\nConsider exporting your modules first as backup.`)) {
                return;
            }
            
            // Remove all uploaded modules
            Object.keys(uploadedModules).forEach(moduleId => {
                removeModule(moduleId, false);
            });
            
            showStatus('‚úì All modules cleared successfully.', 'success');
        }
        
        function showStatus(message, type) {
            const statusDiv = document.getElementById('uploadStatus');
            statusDiv.innerHTML = message;
            statusDiv.style.background = type === 'success' ? '#dcfce7' : '#fef2f2';
            statusDiv.style.color = type === 'success' ? '#065f46' : '#991b1b';
            statusDiv.style.border = type === 'success' ? '1px solid #10b981' : '1px solid #ef4444';
            
            // Auto-clear status after 5 seconds
            setTimeout(() => {
                statusDiv.innerHTML = '';
                statusDiv.style.background = '';
                statusDiv.style.color = '';
                statusDiv.style.border = '';
            }, 5000);
        }
        
        function validateModuleData(data) {
            return data.moduleId && 
                   data.moduleName && 
                   data.moduleIcon && 
                   Array.isArray(data.lessons) && 
                   data.lessons.length > 0;
        }
        
        function integrateModule(moduleData) {
            // Add module to training data
            trainingData.modules[moduleData.moduleId] = {
                name: moduleData.moduleName,
                icon: moduleData.moduleIcon,
                lessons: moduleData.lessons.map(lesson => lesson.lessonId)
            };
            
            // Add lessons to training data
            moduleData.lessons.forEach(lesson => {
                trainingData.lessons[lesson.lessonId] = {
                    title: lesson.title,
                    module: moduleData.moduleId
                };
                
                createLessonHTML(lesson, moduleData.moduleId);
            });
            
            // Update navigation and stats
            generateNavigation();
            updateProgressTracking();
            updateStats();
        }
        
        function createLessonHTML(lesson, moduleId) {
            const contentArea = document.querySelector('.content-area');
            const lessonDiv = document.createElement('div');
            lessonDiv.id = `lesson-${lesson.lessonId}`;
            lessonDiv.className = 'lesson-content';
            
            let sectionsHTML = '';
            if (lesson.sections) {
                lesson.sections.forEach(section => {
                    sectionsHTML += `
                        <div class="section ${section.type}">
                            <div class="section-header">
                                <span class="section-icon">${section.icon}</span>
                                <h2 class="section-title">${section.title}</h2>
                            </div>
                            ${section.content}
                        </div>
                    `;
                });
            }
            
            lessonDiv.innerHTML = `
                <div class="lesson-header">
                    <h1 class="lesson-title">${lesson.title}</h1>
                    <div class="lesson-meta">
                        <span>üìä Module: ${trainingData.modules[moduleId].name}</span>
                        <span>‚è±Ô∏è ${lesson.duration}</span>
                        <span>üìà ${lesson.level}</span>
                    </div>
                    <div class="lesson-objectives">
                        <h3>Learning Objectives:</h3>
                        <ul>
                            ${lesson.objectives.map(obj => `<li>${obj}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                ${sectionsHTML}
                <div class="lesson-nav">
                    <button class="btn btn-secondary" onclick="showDashboard()">‚Üê Back to Dashboard</button>
                    <button class="btn btn-success" onclick="completeLesson('${lesson.lessonId}')">Mark as Complete ‚úì</button>
                </div>
            `;
            
            contentArea.appendChild(lessonDiv);
        }
        
        function downloadTemplate() {
            const template = {
                "moduleId": "advanced-topics",
                "moduleName": "Advanced Topics",
                "moduleIcon": "üöÄ",
                "lessons": [
                    {
                        "lessonId": "backup-recovery",
                        "title": "Backup and Recovery",
                        "duration": "45 minutes",
                        "level": "Advanced",
                        "objectives": [
                            "Understand AD backup strategies",
                            "Learn system state backup procedures",
                            "Practice disaster recovery scenarios"
                        ],
                        "sections": [
                            {
                                "type": "concept",
                                "icon": "üíæ",
                                "title": "Backup Strategies",
                                "content": "<h3>System State Backup</h3><p>The system state includes the Active Directory database, SYSVOL, registry, and other critical system files.</p><div class='highlight-box'><strong>Backup Components:</strong><ul><li>NTDS.dit database file</li><li>SYSVOL folder</li><li>Registry settings</li></ul></div>"
                            }
                        ]
                    }
                ]
            };
            
            const blob = new Blob([JSON.stringify(template, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ad-training-module-template.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function toggleTemplate() {
            const example = document.querySelector('.template-example');
            const toggle = document.getElementById('templateToggle');
            
            example.classList.toggle('open');
            toggle.textContent = example.classList.contains('open') ? '‚ñ≤' : '‚ñº';
        }
        
        function updateStats() {
            const totalLessons = Object.keys(trainingData.lessons).length;
            const totalModules = Object.keys(trainingData.modules).length;
            
            document.getElementById('totalLessons').textContent = totalLessons;
            document.getElementById('totalModules').textContent = totalModules;
        }

        // Core Functions
        function generateNavigation() {
            const nav = document.getElementById('moduleNavigation');
            nav.innerHTML = '';
            
            Object.entries(trainingData.modules).forEach(([moduleId, module]) => {
                const completedLessons = module.lessons.filter(lessonId => userProgress[lessonId]?.completed).length;
                const totalLessons = module.lessons.length;
                const isModuleComplete = completedLessons === totalLessons;
                
                const moduleDiv = document.createElement('div');
                moduleDiv.className = 'module-nav';
                
                const moduleHeader = document.createElement('div');
                moduleHeader.className = `module-header ${isModuleComplete ? 'completed' : ''}`;
                moduleHeader.innerHTML = `
                    <span>${module.icon} ${module.name}</span>
                    <span class="completion-count">${completedLessons}/${totalLessons}</span>
                `;
                
                moduleDiv.appendChild(moduleHeader);
                
                module.lessons.forEach(lessonId => {
                    const lesson = trainingData.lessons[lessonId];
                    const isCompleted = userProgress[lessonId]?.completed;
                    const isActive = currentLesson === lessonId;
                    
                    const lessonDiv = document.createElement('div');
                    lessonDiv.className = `lesson-item ${isCompleted ? 'completed' : ''} ${isActive ? 'active' : ''}`;
                    lessonDiv.textContent = lesson.title;
                    lessonDiv.onclick = () => loadLesson(lessonId);
                    
                    moduleDiv.appendChild(lessonDiv);
                });
                
                nav.appendChild(moduleDiv);
            });
        }

        function updateProgressTracking() {
            const totalLessons = Object.keys(trainingData.lessons).length;
            const completedLessons = Object.values(userProgress).filter(p => p && p.completed).length;
            const progressPercent = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;
            
            const progressFill = document.getElementById('overallProgress');
            const progressText = document.getElementById('progressText');
            
            if (progressFill) {
                progressFill.style.width = progressPercent + '%';
            }
            if (progressText) {
                progressText.textContent = progressPercent + '% Complete';
            }
            
            const completedLessonsEl = document.getElementById('completedLessons');
            if (completedLessonsEl) completedLessonsEl.textContent = completedLessons;
        }

        function showDashboard() {
            currentView = 'dashboard';
            currentLesson = null;
            
            document.querySelectorAll('.lesson-content').forEach(el => {
                el.classList.remove('active');
            });
            
            document.getElementById('dashboardView').style.display = 'block';
            
            document.getElementById('pageTitle').textContent = 'Active Directory Complete Training';
            document.getElementById('pageSubtitle').textContent = 'Comprehensive training with module management system';
            
            generateNavigation();
            updateProgressTracking();
        }

        function loadLesson(lessonId) {
            currentView = 'lesson';
            currentLesson = lessonId;
            
            const lesson = trainingData.lessons[lessonId];
            if (!lesson) {
                console.error('Lesson not found:', lessonId);
                return;
            }
            
            document.getElementById('dashboardView').style.display = 'none';
            
            document.querySelectorAll('.lesson-content').forEach(el => {
                el.classList.remove('active');
            });
            
            const lessonEl = document.getElementById(`lesson-${lessonId}`);
            if (lessonEl) {
                lessonEl.classList.add('active');
            }
            
            document.getElementById('pageTitle').textContent = lesson.title;
            document.getElementById('pageSubtitle').textContent = `Module: ${trainingData.modules[lesson.module].name}`;
            
            if (!userProgress[lessonId]) {
                userProgress[lessonId] = { 
                    completed: false, 
                    lastAccessed: new Date().toISOString() 
                };
            }
            
            generateNavigation();
        }

        function completeLesson(lessonId) {
            if (!userProgress[lessonId]) {
                userProgress[lessonId] = {};
            }
            
            userProgress[lessonId].completed = true;
            userProgress[lessonId].completedDate = new Date().toISOString();
            
            updateProgressTracking();
            generateNavigation();
            alert(`Lesson "${trainingData.lessons[lessonId].title}" completed successfully!`);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = '#10b981';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#374151';
                }, 1000);
            }).catch(err => {
                alert('Command copied: ' + text);
            });
        }
    </script>

</body></html>
